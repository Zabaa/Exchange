@using Exchange.Infrastructure.Extensions
@model IEnumerable<Exchange.ViewModel.Auction.AuctionGridViewModel>
@{
    ViewBag.Title = "Aukcje";
}

<h2>Moje aukcje</h2>
@Html.ActionLink("Dodaj", "Add", "Auction", new { @class = "btn btn-default", id="btn-add" })

<div class="modal fade" id="dialogDiv" tabindex="-1" role="dialog">
    <div class="modal-dialog" id="dialogContent" role="document">
    </div>
</div>


<div id="auctionTable" class="row">
    <table class="table table-striped table-bordered">
        <thead>
        <tr>
            <th>Nazwa</th>
            <th>Opis</th>
            <th>Cena otwarcia</th>
            <th>Data rozpoczęcia</th>
            <th>Status</th>
            <th>Operacje</th>
        </tr>
        </thead>
        <tbody>
        @foreach (var auction in Model)
        {
            <tr>
                <td>@auction.Name</td>
                <td>@auction.Description</td>
                <td>@auction.OpenPrice</td>
                <td>@auction.StartDate</td>
                <td>@auction.Status.GetDescription()</td>
                <td>
                    @Html.ActionLink("Szczegóły", "Details", "Auction", new {id = auction.Id}, new {@class = "btn-details"})
                </td>
            </tr>
        }
        </tbody>
    </table>
</div>

@section scripts
{
    <script>
        $(document).ready(function() {
            $('.btn-details').on('click', function() {
                $('#dialogContent').load(this.href, function() {
                    $('#dialogDiv').modal({
                        backdrop: 'static',
                        keyboard: true
                    }, 'show');
                });
                return false;
            });

            $('#btn-add').on('click', function () {
                $('#dialogContent').load(this.href, function () {
                    $('#dialogDiv').modal({
                        backdrop: 'static',
                        keyboard: true
                    }, 'show');
                });
                return false;
            });

            //$('btn-details').on('click', function() {
            //    e.preventDefault();
            //    var url = $(this).attr('href');
            //    $.ajax({
            //        url: url,
            //        type: 'GET',
            //        success: function(html) {
            //            $('.modal-dialog #auctionModal').html(html);
            //            $('#auctionModal').modal({
            //                backdrop: 'static',
            //                keyboard: true
            //            }, 'show');

            //        }
            //    });
            //});
        });
    </script>
}
